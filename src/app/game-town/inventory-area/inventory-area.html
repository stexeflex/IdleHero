<div class="inventory">
  <div class="header">
    <div class="title">
      <h3>BAG</h3>
      <div class="meta">
        <span class="count">{{ FilteredCount() }} / {{ TotalItems() }} Items</span>
        <span class="separator">â€¢</span>
        <span class="capacity">{{ SlotsUsed() }} / {{ Capacity() }} Capacity</span>
      </div>
    </div>

    <div class="actions">
      <button
        type="button"
        class="ih-button-secondary"
        [disabled]="!HasActiveFilters()"
        (click)="ResetFilters()">
        RESET FILTERS
      </button>
    </div>
  </div>

  <div class="filters">
    <div class="filter-group">
      <div class="filter-title">SLOTS</div>
      <div class="chip-row">
        @for (slot of AllSlots; track slot) {
          <button
            type="button"
            class="chip"
            [class.is-active]="IsSlotSelected(slot)"
            (click)="ToggleSlot(slot)">
            <app-icon [gear]="DefaultSlotIcons[slot]" size="sm"></app-icon>
            {{ slot.toUpperCase() }}
          </button>
        }
      </div>
    </div>

    <div class="filter-group">
      <div class="filter-title">TIERS</div>
      <div class="chip-row">
        @for (tier of AllTiers; track tier) {
          <button
            type="button"
            class="chip"
            [class.is-active]="IsTierSelected(tier)"
            (click)="ToggleTier(tier)">
            TIER {{ tier }}
          </button>
        }
      </div>
    </div>

    <div class="filter-group">
      <div class="filter-title">RARITY</div>
      <div class="chip-row">
        @for (rarity of AllRarities; track rarity) {
          <button
            type="button"
            class="chip"
            [class.is-active]="IsRaritySelected(rarity)"
            (click)="ToggleRarity(rarity)">
            {{ rarity.toUpperCase() }}
          </button>
        }
      </div>
    </div>
  </div>

  @if (FilteredItemCards().length === 0) {
    <div class="empty">
      <div class="headline">Nothing to show</div>
      <div class="hint">Adjust your filters or craft new gear.</div>
    </div>
  } @else {
    <div class="grid">
      @for (card of FilteredItemCards(); track card.Item.Id) {
        <div class="grid-cell">
          <app-item-preview [Item]="card.Item" [Variant]="card.Variant">
            <separator class="ih-separator"></separator>
            <div class="item-preview-actions">
              @if (IsDismantlingItem() !== card.Item) {
                <button class="ih-button-tertiary button-equip" (click)="EquipItem(card.Item)">
                  EQUIP
                </button>
              }
              <button
                class="ih-button-tertiary button-dismantle"
                (click)="
                  IsDismantlingItem() ? DismantleItem(card.Item) : StartDismantling(card.Item)
                ">
                @if (IsDismantlingItem() === card.Item) {
                  <app-loading-spinner [size]="16" [color]="'#fff'"></app-loading-spinner>
                  CONFIRM
                } @else {
                  DISMANTLE
                }
              </button>
            </div>
          </app-item-preview>
        </div>
      }
    </div>
  }
</div>
